
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Hello World</title>
    <script src="react.development.js"></script>
    <script src="react-dom.development.js"></script>

    <!-- Don't use this in production: -->
    <script src="babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel" data-presets="react">
      var { useState, useCallback, useEffect, memo } = React

      // è¢«React.memoåŒ…è£¹çš„ç»„ä»¶ï¼Œå¦‚æœæ–°ä¼ å…¥çš„propsæ²¡æœ‰å‘ç”Ÿå˜åŒ–
      // åˆ™ä¸æ›´æ–°ç»„ä»¶
      var Button = memo(function Button(props) {
        console.log('Button render')
        var {children, className, ...restProps} = props
        return <button {...restProps} className={`border p-1 rounded text-white bg-slate-500 ${className}`}>{children}</button>
      })


      function isEqual(obj1, obj2) {
        for (var key in obj1) {
          if (obj1[key] !== obj2[key]) {
            return false
          }
        }
        return true
      }

      // class Button extends React.PureComponent {
      //   // shouldComponentUpdate(nextProps, nextState) {
      //   //   if (isEqual(this.props, nextProps)) {
      //   //     return false
      //   //   }
      //   //   return true
      //   // }
      //   render() {
      //     console.log('Button render')
      //     var {children, className, ...restProps} = this.props
      //     return <button {...restProps} className={`border p-1 rounded text-white bg-slate-500 ${className}`}>{children}</button>
      //   }
      // }

      var map = {
        heart: 'ğŸ’•',
        star: 'â­',
        smile: 'ğŸ˜Š'
      }
      function Icon({ iconName }) {
        return <i className="font-normal">{map[iconName] ?? 'error'}</i>
      }

      function Carousel({ imgs }) {
        var [i, setI] = useState(0)
        // console.log(setI)

        const prev = useCallback(function prev() {
          setI(i => {
            var newI = i - 1
            if (newI < 0) {
              newI = imgs.length - 1
            }
            return newI
          })
        }, [])

        // const next = useCallback(function next() {
        //   setI(i + 1 >= imgs.length ? 0 : i + 1)
        // }, [i])

        function next() {
          setI(i => i + 1 >= imgs.length ? 0 : i + 1)
        }

        return (
          <div className="w-[200px] h-[150px] border relative">
            <a className="absolute w-full h-full" target="_blank" href={imgs[i].link}>
              <img className="block w-full h-full" src={imgs[i].imgUrl}/>
            </a>
            <button onClick={prev} className="absolute left-0 w-4 h-4 top-1/2" >prev</button>
            <Button onClick={next} className="absolute right-0 w-4 h-4 top-1/2" >next</Button>
          </div>
        )
      }


      /**
       * å‡½æ•°ç»„ä»¶çš„æ¯ä¸ªç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°
       * ä½†è¿™ä¸ªå‡½æ•°ä¸æ˜¯å½“æ„é€ å‡½æ•°è°ƒç”¨çš„ï¼Œå°±æ˜¯å½“æ™®é€šå‡½æ•°è°ƒç”¨çš„
       * é‡Œé¢çš„thisæ˜¯undefinedæˆ–windowï¼Œä¹Ÿå°±æ˜¯è¯´å®Œå…¨å»thisåŒ–äº†
       * 
       * å‡½æ•°ç»„ä»¶ä¼šæ¥æ”¶ä¸€ä¸ªå‚æ•°propsï¼Œå…¶è¡¨ç¤ºè¯¥ç»„ä»¶åœ¨è¢«ä½¿ç”¨æ—¶ä¼ å…¥çš„å‚æ•°
       * 
       * å‡½æ•°ç»„ä»¶ä»¥å‰æ˜¯æ²¡æœ‰çŠ¶æ€çš„ï¼Œæ‰€ä»¥æ›¾ç»å«stateless functional component
       */
      function MyApp() {
        return (
          <div>

            <Carousel imgs={
              [
                {
                  imgUrl: 'https://dummyimage.com/600x400/000/fff',
                  link: ''
                },
                {
                  imgUrl: 'https://dummyimage.com/600x400/f0f/abc',
                  link: '',
                },
              ]
            } />


            <Icon name="smile" />
            <Icon name="heart" />

            <Button id="foo" title="owe" onClick={ () => console.log(1) }>
              hello
              <span>we<i>i</i>jf</span>
            </Button>
          </div>
        )
      }

      const container = document.getElementById('root')
      const root = ReactDOM.createRoot(container)
      root.render(<MyApp />)

    </script>
  </body>
</html>